{"remainingRequest":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/table-extend/dap-ui-table-extend.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/table-extend/dap-ui-table-extend.vue","mtime":1582480097285},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJbnB1dENvbXBvbmVudE1peGluIGZyb20gIi4uLy4uLy4uL21peGlucy9pbnB1dC1jb21wb25lbnQtbWl4aW4uanMiOwppbXBvcnQgQmFzaWNDb21wb25lbnRNaXhpbiBmcm9tICIuLi8uLi8uLi9taXhpbnMvYmFzaWMtY29tcG9uZW50LW1peGluLmpzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRGFwVWlUYWJsZUV4dGVuZCIsCiAgdHlwZTogIkZPUk1fSU5QVVQiLAogIG1peGluczogW0lucHV0Q29tcG9uZW50TWl4aW4sIEJhc2ljQ29tcG9uZW50TWl4aW5dLAogIHByb3BzOiB7CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFibGVCYXNlQ29uZmlnOiB7CiAgICAgICAgc2VsZWN0TW9kZTogIiIsCiAgICAgICAgbWF4SGVpZ2h0OiAiMjQwcHgiLAogICAgICAgIHZpcnR1YWxMaXN0OiB0cnVlCiAgICAgIH0sCiAgICAgIHZlcnRpY2FsVGFibGVCYXNlQ29uZmlnOiB7CiAgICAgICAgc2VsZWN0TW9kZTogIiIsCiAgICAgICAgbWF4SGVpZ2h0OiAiMjQwcHgiLAogICAgICAgIHZpcnR1YWxMaXN0OiB0cnVlCiAgICAgIH0sCiAgICAgIGRpc3BsYXlUeXBlOiAiaG9yaXpvbnRhbCIsCiAgICAgIGRpc3BsYXlUeXBlTGFiZWxzOiBbCiAgICAgICAgewogICAgICAgICAgbGFiZWw6ICLmqKrlkJEo5YiX6KGoKSIsCiAgICAgICAgICB2YWx1ZTogImhvcml6b250YWwiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogIue6teWQkSjljZXmnaHmmI7nu4YpIiwKICAgICAgICAgIHZhbHVlOiAidmVydGljYWwiCiAgICAgICAgfQogICAgICBdLAogICAgICByZWFkT25seTogZmFsc2UKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgJ2V4dHJhUHJvcC5jb2x1bW5zJzogewogICAgICBoYW5kbGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICAgIGlmIChuZXdWYWx1ZSkgewogICAgICAgICAgY29uc3QgY29sdW1ucyA9IG5ld1ZhbHVlOwogICAgICAgICAgdGhpcy50YWJsZUJhc2VDb25maWcuY29sdW1ucyA9IGNvbHVtbnM7IC8vIOaoquWQkeihqOagvAogICAgICAgICAgdGhpcy52ZXJ0aWNhbFRhYmxlQmFzZUNvbmZpZy5jb2x1bW5zID0gWwogICAgICAgICAgICB7IGZpZWxkOiAiXyIsIHRpdGxlOiAiIiwgc2xvdE5hbWU6ICJjdXN0b21Db2x1bW4iIH0KICAgICAgICAgIF07IC8vIOe6teWQkeihqOagvAogICAgICAgICAgLy8gcmVhZG9ubHkKICAgICAgICAgIGNvbnN0IGZsYWcgPSBuZXdWYWx1ZS5ldmVyeShpdGVtID0+IGl0ZW0ucmVhZE9ubHkpOwogICAgICAgICAgdGhpcy5yZWFkT25seSA9IGZsYWc7CiAgICAgICAgICBpZiAoZmxhZykgewogICAgICAgICAgICB0aGlzLnRhYmxlQmFzZUNvbmZpZy5zZWxlY3RNb2RlID0gIiI7CiAgICAgICAgICAgIHRoaXMudmVydGljYWxUYWJsZUJhc2VDb25maWcuc2VsZWN0TW9kZSA9ICIiOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy50YWJsZUJhc2VDb25maWcuc2VsZWN0TW9kZSA9ICJtdWx0aXBhcnQiOwogICAgICAgICAgICB0aGlzLnZlcnRpY2FsVGFibGVCYXNlQ29uZmlnLnNlbGVjdE1vZGUgPSAibXVsdGlwYXJ0IjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGltbWVkaWF0ZTogdHJ1ZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2Nyb2xsVG9MYXN0Um93KCkgewogICAgICBjb25zdCByb3cgPSB0aGlzLnZhbHVlW3RoaXMudmFsdWUubGVuZ3RoIC0gMV07CiAgICAgIGlmICh0aGlzLmRpc3BsYXlUeXBlID09PSAiaG9yaXpvbnRhbCIpIHsKICAgICAgICB0aGlzLiRyZWZzLmhvcml6b250YWxUYWJsZS5zY3JvbGxUb1Jvdyhyb3cpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJlZnMudmVydGljYWxUYWJsZS5zY3JvbGxUb1Jvdyhyb3cpOwogICAgICB9CiAgICB9LAogICAgZ2V0Q2hlY2tlZERhdGEoKSB7CiAgICAgIGxldCBjaGVja2VkRGF0YTsKICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICJob3Jpem9udGFsIikgewogICAgICAgIGNoZWNrZWREYXRhID0gdGhpcy4kcmVmcy5ob3Jpem9udGFsVGFibGUuZ2V0Q2hla2NlZCgpOwogICAgICB9IGVsc2UgewogICAgICAgIGNoZWNrZWREYXRhID0gdGhpcy4kcmVmcy52ZXJ0aWNhbFRhYmxlLmdldENoZWtjZWQoKTsKICAgICAgfQogICAgICByZXR1cm4gY2hlY2tlZERhdGE7CiAgICB9LAogICAgb25DbGlja0FkZChlKSB7CiAgICAgIGNvbnN0IG9iaiA9IHt9OwogICAgICB0aGlzLnRhYmxlQmFzZUNvbmZpZy5jb2x1bW5zLm1hcChpdGVtID0+IHsKICAgICAgICBvYmpbaXRlbS5maWVsZF0gPSB1bmRlZmluZWQ7CiAgICAgIH0pOwogICAgICB0aGlzLnZhbHVlLnB1c2gob2JqKTsKICAgICAgdGhpcy5zY3JvbGxUb0xhc3RSb3coKTsKICAgICAgdGhpcy4kZm9ybUV2ZW50RW1pdCgnYWRkLXJlY29yZCcsIHsKICAgICAgICBtb3VzZUV2ZW50OiBlCiAgICAgIH0pOwogICAgfSwKICAgIG9uQ2xpY2tDb3B5KGUpIHsKICAgICAgY29uc3QgY2hlY2tlZERhdGEgPSB0aGlzLmdldENoZWNrZWREYXRhKCk7CiAgICAgIGNvbnN0IGFyciA9IFtdOwogICAgICBjaGVja2VkRGF0YS5tYXAoaXRlbSA9PiB7CiAgICAgICAgY29uc3Qgb2JqID0ge307CiAgICAgICAgdGhpcy50YWJsZUJhc2VDb25maWcuY29sdW1ucy5tYXAoY29sdW1uID0+IHsKICAgICAgICAgIG9ialtjb2x1bW4uZmllbGRdID0gaXRlbVtjb2x1bW4uZmllbGRdOwogICAgICAgIH0pOwogICAgICAgIGFyci5wdXNoKG9iaik7CiAgICAgIH0pOwogICAgICB0aGlzLnZhbHVlLnB1c2goLi4uYXJyKTsKICAgICAgdGhpcy5zY3JvbGxUb0xhc3RSb3coKTsKICAgICAgdGhpcy4kZm9ybUV2ZW50RW1pdCgnY29weS1yZWNvcmQnLCB7CiAgICAgICAgbW91c2VFdmVudDogZQogICAgICB9KTsKICAgIH0sCiAgICBvbkNsaWNrRGVsZXRlKGUpIHsKICAgICAgY29uc3QgY2hlY2tlZERhdGEgPSB0aGlzLmdldENoZWNrZWREYXRhKCk7CiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBjaGVja2VkRGF0YSkgewogICAgICAgIHRoaXMudmFsdWUuc3BsaWNlKHRoaXMudmFsdWUuaW5kZXhPZihpdGVtKSwgMSk7CiAgICAgIH0KICAgICAgdGhpcy4kZm9ybUV2ZW50RW1pdCgnZGVsZXRlLXJlY29yZCcsIHsKICAgICAgICBtb3VzZUV2ZW50OiBlLAogICAgICAgIGNoZWNrZWREYXRhOiBjaGVja2VkRGF0YQogICAgICB9KTsKICAgIH0sCiAgICBvbkNlbGxDbGljayhlKSB7CiAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoJ2NlbGwtY2xpY2snLCBlKTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["dap-ui-table-extend.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dap-ui-table-extend.vue","sourceRoot":"packages/components/form/table-extend","sourcesContent":["<!--\n * @Author: your name\n * @Date: 2020-02-20 10:13:07\n * @LastEditTime: 2020-02-23 15:08:42\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /dap-vue-ui/packages/components/form/table-extend/dap-ui-table-extend.vue\n -->\n<template>\n  <div class=\"dap-ui-table-extend\">\n    <div class=\"dap-ui-table-extend-title\">\n      <div class=\"title\">\n        <span :style=\"{'color': labelColor}\">{{ label }}</span>\n      </div>\n      <div class=\"operation\">\n        <span>显示方式：</span>\n        <a-radio-group v-model=\"displayType\">\n          <a-radio\n            v-for=\"(item, index) in displayTypeLabels\"\n            :key=\"index\"\n            :value=\"item.value\"\n          >{{ item.label }}</a-radio>\n        </a-radio-group>\n        <a-button v-if=\"!readOnly\" type=\"primary\" size=\"small\" @click=\"onClickAdd\">新建记录</a-button>\n        <a-button v-if=\"!readOnly\" style=\"margin-left: 1rem;\" type=\"primary\" size=\"small\" @click=\"onClickCopy\">复制新建</a-button>\n        <a-button v-if=\"!readOnly\" style=\"margin-left: 1rem;\" type=\"default\" size=\"small\" @click=\"onClickDelete\">删除</a-button>\n      </div>\n    </div>\n    <dap-ui-table\n      v-if=\"displayType === 'horizontal'\"\n      ref=\"horizontalTable\"\n      :table-data.sync=\"value\"\n      :table-base-config=\"tableBaseConfig\"\n      @cell-click=\"onCellClick\"\n    ></dap-ui-table>\n    <div v-if=\"displayType === 'vertical'\" class=\"vertical-table\">\n      <dap-ui-table\n        ref=\"verticalTable\"\n        :table-data.sync=\"value\"\n        :table-base-config=\"verticalTableBaseConfig\"\n        @cell-click=\"onCellClick\"\n      >\n        <template v-slot:customColumn=\"{ row, rowIndex }\">\n          <div class=\"vertical-row\">\n            <div class=\"column\" v-for=\"(column, index) in tableBaseConfig.columns\" :key=\"index\">\n              <a-tooltip :title=\"column.title\">\n                <span class=\"label\" :class=\"{ required: column.required }\">{{ column.title }}：</span>\n              </a-tooltip>\n              <div class=\"value\">{{ row[column.field] }}</div>\n            </div>\n          </div>\n        </template>\n      </dap-ui-table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport InputComponentMixin from \"../../../mixins/input-component-mixin.js\";\nimport BasicComponentMixin from \"../../../mixins/basic-component-mixin.js\";\n\nexport default {\n  name: \"DapUiTableExtend\",\n  type: \"FORM_INPUT\",\n  mixins: [InputComponentMixin, BasicComponentMixin],\n  props: {\n  },\n  data() {\n    return {\n      tableBaseConfig: {\n        selectMode: \"\",\n        maxHeight: \"240px\",\n        virtualList: true\n      },\n      verticalTableBaseConfig: {\n        selectMode: \"\",\n        maxHeight: \"240px\",\n        virtualList: true\n      },\n      displayType: \"horizontal\",\n      displayTypeLabels: [\n        {\n          label: \"横向(列表)\",\n          value: \"horizontal\"\n        },\n        {\n          label: \"纵向(单条明细)\",\n          value: \"vertical\"\n        }\n      ],\n      readOnly: false\n    };\n  },\n  watch: {\n    'extraProp.columns': {\n      handler(newValue, oldValue) {\n        if (newValue) {\n          const columns = newValue;\n          this.tableBaseConfig.columns = columns; // 横向表格\n          this.verticalTableBaseConfig.columns = [\n            { field: \"_\", title: \"\", slotName: \"customColumn\" }\n          ]; // 纵向表格\n          // readonly\n          const flag = newValue.every(item => item.readOnly);\n          this.readOnly = flag;\n          if (flag) {\n            this.tableBaseConfig.selectMode = \"\";\n            this.verticalTableBaseConfig.selectMode = \"\";\n          } else {\n            this.tableBaseConfig.selectMode = \"multipart\";\n            this.verticalTableBaseConfig.selectMode = \"multipart\";\n          }\n        }\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    scrollToLastRow() {\n      const row = this.value[this.value.length - 1];\n      if (this.displayType === \"horizontal\") {\n        this.$refs.horizontalTable.scrollToRow(row);\n      } else {\n        this.$refs.verticalTable.scrollToRow(row);\n      }\n    },\n    getCheckedData() {\n      let checkedData;\n      if (this.displayType === \"horizontal\") {\n        checkedData = this.$refs.horizontalTable.getChekced();\n      } else {\n        checkedData = this.$refs.verticalTable.getChekced();\n      }\n      return checkedData;\n    },\n    onClickAdd(e) {\n      const obj = {};\n      this.tableBaseConfig.columns.map(item => {\n        obj[item.field] = undefined;\n      });\n      this.value.push(obj);\n      this.scrollToLastRow();\n      this.$formEventEmit('add-record', {\n        mouseEvent: e\n      });\n    },\n    onClickCopy(e) {\n      const checkedData = this.getCheckedData();\n      const arr = [];\n      checkedData.map(item => {\n        const obj = {};\n        this.tableBaseConfig.columns.map(column => {\n          obj[column.field] = item[column.field];\n        });\n        arr.push(obj);\n      });\n      this.value.push(...arr);\n      this.scrollToLastRow();\n      this.$formEventEmit('copy-record', {\n        mouseEvent: e\n      });\n    },\n    onClickDelete(e) {\n      const checkedData = this.getCheckedData();\n      for (const item of checkedData) {\n        this.value.splice(this.value.indexOf(item), 1);\n      }\n      this.$formEventEmit('delete-record', {\n        mouseEvent: e,\n        checkedData: checkedData\n      });\n    },\n    onCellClick(e) {\n      this.$formEventEmit('cell-click', e);\n    }\n  }\n};\n</script>\n<style src=\"./index.less\" lang=\"less\"></style>\n"]}]}