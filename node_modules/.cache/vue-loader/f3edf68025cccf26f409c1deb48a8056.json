{"remainingRequest":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/input-money/dap-ui-input-money.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/input-money/dap-ui-input-money.vue","mtime":1583476762827},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJbnB1dENvbXBvbmVudE1peGluIGZyb20gJy4uLy4uLy4uL21peGlucy9pbnB1dC1jb21wb25lbnQtbWl4aW4uanMnOwppbXBvcnQgQmFzaWNDb21wb25lbnRNaXhpbiBmcm9tICcuLi8uLi8uLi9taXhpbnMvYmFzaWMtY29tcG9uZW50LW1peGluLmpzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRGFwVWlJbnB1dE1vbmV5IiwKICB0eXBlOiAnRk9STV9JTlBVVCcsCiAgbWl4aW5zOiBbSW5wdXRDb21wb25lbnRNaXhpbiwgQmFzaWNDb21wb25lbnRNaXhpbl0sCiAgY29tcHV0ZWQ6IHsKICAKICB9LAogIHByb3BzOiB7CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YTogIiIsIC8vIOmcgOaxguS4uuWkseeEpuagvOW8j+WMlu+8jOaJgOS7peimgeeUqGRhdGHlgZrkuK3pl7TmlbDmja7vvIzogIzkuI3mmK/nm7TmjqXnlKjniLbnu4Tku7bnmoR2YWx1ZQogICAgICBmbGFnOiBmYWxzZSAvLyBmbGFnIOeUqOS6juWIpOaWreaYr+WQpumcgOimgeagvOW8j+WMlumHkemine+8jOS4umZhbHNl5pe25qC85byP5YyWCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgdmFsdWUgOiB7CiAgICAgIGhhbmRsZXIgKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICAgIGlmICghdGhpcy5mbGFnKSB7CiAgICAgICAgICBpZiAocGFyc2VGbG9hdChuZXdWYWx1ZSkgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5kYXRhID0gIjAuMDAiOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKG5ld1ZhbHVlKSB7CiAgICAgICAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5mb3JtYXRUaG91c2FuZHRoKG5ld1ZhbHVlLnRvU3RyaW5nKCksIDIsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgaW1tZWRpYXRlOnRydWUsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvKioKICAgICAqIEBhdXRob3IgbGl6aGloYW5nCiAgICAgKiBAcGFyYW0gZSBldmVudAogICAgICogQGRlc2NyaXB0aW9uIOWAvOaUueWPmOS6i+S7tu+8jOWPquWFgeiuuOi+k+WFpeaVsOWtl+ebuOWFswogICAgICogQGRhdGUgMjAyMC0yLTI2CiAgICAgKi8KICAgIGRhdGFDaGFuZ2VFdmVudChlKSB7CiAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IGUudGFyZ2V0OwogICAgICBjb25zdCByZWcgPSAvXi0/KDB8WzEtOV1bMC05XSopKFwuWzAtOV0qKT8kLzsgLy8g5pWw5a2X5q2j5YiZCiAgICAgIGlmICgoIWlzTmFOKHZhbHVlKSAmJiByZWcudGVzdCh2YWx1ZSkpIHx8IHZhbHVlID09PSAnJyB8fCB2YWx1ZSA9PT0gJy0nKSB7CiAgICAgICAgaWYgKHZhbHVlID09PSAnJykgeyAvLyDlpoLmnpzlgLzkuLrnqbog5o+Q56S65qCh6aqM5paH5a2X77yM5LiN5Li656m65pe25Y+mdmFsdWXkuLowIOWFs+mXreagoemqjOaWh+Wtl++8jOWcqOWkseeEpuS6i+S7tuaXtuWwhnZhbHVl5Zyo5aSN5Yi25oiQ5q2j56Gu55qE5YC8CiAgICAgICAgICB0aGlzLmZsYWcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoJ2NoYW5nZScsIHVuZGVmaW5lZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZmxhZyA9IHRydWU7CiAgICAgICAgICB0aGlzLiRmb3JtRXZlbnRFbWl0KCdjaGFuZ2UnLCAwKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5kYXRhID0gdmFsdWU7IAogICAgICB9IGVsc2UgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9CiAgICB9LAogICAgLyoqCiAgICAgKiBAYXV0aG9yIGxpemhpaGFuZwogICAgICogQHBhcmFtIGUgZXZlbnQKICAgICAqIEBkZXNjcmlwdGlvbiDlpLHnhKbkuovku7bvvIzmlLnlj5jniLbnu4Tku7bkvKDmnaXnmoR2YWx1ZeWAvAogICAgICogQGRhdGUgMjAxOS0yLTI2CiAgICAgKi8KICAgIGZvcm1hdE1vbmV5KGUpIHsKICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gZS50YXJnZXQ7CiAgICAgIHRoaXMuZmxhZyA9IGZhbHNlOwogICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlID09PSAiLSIpIHsKICAgICAgICB0aGlzLiRmb3JtRXZlbnRFbWl0KCdjaGFuZ2UnLCB1bmRlZmluZWQpOwogICAgICAgIHRoaXMuZGF0YSA9ICIiOwogICAgICB9IGVsc2UgaWYgKHBhcnNlRmxvYXQodmFsdWUpID09PSAwKSB7CiAgICAgICAgdGhpcy4kZm9ybUV2ZW50RW1pdCgnY2hhbmdlJywgMCk7CiAgICAgICAgdGhpcy5kYXRhID0gIjAuMDAiCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGZvcm1hdGVkTW9uZXkgPSB0aGlzLmZvcm1hdFRob3VzYW5kdGgodmFsdWUsIDIsIHRydWUpOwogICAgICAgIHRoaXMuZGF0YSA9IGZvcm1hdGVkTW9uZXk7CiAgICAgICAgZm9ybWF0ZWRNb25leSA9IGZvcm1hdGVkTW9uZXkucmVwbGFjZSgvXCwvZywgJycpOwogICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoJ2NoYW5nZScsIHBhcnNlRmxvYXQoZm9ybWF0ZWRNb25leSkpOwogICAgICB9CiAgICB9LAogICAgLyoqCiAgICAgKiBAYXV0aG9yIGxpemhpaGFuZwogICAgICogQGRlc2NyaXB0aW9uIGZvdXPkuovku7bvvIzljrvpmaTpgJflj7cKICAgICAqIEBkYXRlIDIwMjAtMi0yNgogICAgICovCiAgICBkZWxldGVDb21tYSgpIHsKICAgICAgdGhpcy5kYXRhID0gdGhpcy5kYXRhLnJlcGxhY2UoL1wsL2csICcnKTsKICAgIH0sCiAgICBmb3JtYXRUaG91c2FuZHRoKG51bSwgY2VudCwgaXNUaG91c2FuZCkgewogICAgICBjb25zdCByZWcgPSAvXGR7MSwzfSg/PShcZHszfSkrJCkvZzsKICAgICAgbGV0IHJlc3VsdDsKICAgICAgaWYgKG51bSB8fCBudW0gPT09IDApIHsKICAgICAgICBudW0gPSBudW0udG9TdHJpbmcoKS5yZXBsYWNlKC8kfCwvZywgIiIpOwogICAgICAgIGNvbnN0IGRvdEluZGV4ID0gbnVtLmluZGV4T2YoIi4iKTsKICAgICAgICBpZiAoZG90SW5kZXggPiAtMSkgewogICAgICAgICAgbGV0IGRvdExlZnQgPSBudW0uc3Vic3RyaW5nKDAsIGRvdEluZGV4KTsKICAgICAgICAgIGlmIChpc1Rob3VzYW5kKSB7CiAgICAgICAgICAgIGRvdExlZnQgPSAoZG90TGVmdCArICIiKS5yZXBsYWNlKHJlZywgIiQmLCIpOwogICAgICAgICAgfQogICAgICAgICAgbGV0IGRvdFJpZ2h0ID0gbnVtLnN1YnN0cmluZyhkb3RJbmRleCArIDEsIGRvdEluZGV4ICsgY2VudCArIDEpOwogICAgICAgICAgaWYgKGRvdFJpZ2h0Lmxlbmd0aCA8IGNlbnQpIHsKICAgICAgICAgICAgd2hpbGUgKGRvdFJpZ2h0Lmxlbmd0aCA8IGNlbnQpIHsKICAgICAgICAgICAgICBkb3RSaWdodCArPSAiMCI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJlc3VsdCA9IGAke2RvdExlZnR9LiR7ZG90UmlnaHR9YDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGlzVGhvdXNhbmQpIHsKICAgICAgICAgICAgcmVzdWx0ID0gKG51bSArICIiKS5yZXBsYWNlKHJlZywgIiQmLCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0ID0gbnVtOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGNlbnQgPiAwKSB7CiAgICAgICAgICAgIHJlc3VsdCArPSAiLiI7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2VudDsgaSsrKSB7CiAgICAgICAgICAgICAgcmVzdWx0ICs9ICIwIjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KfQo="},{"version":3,"sources":["dap-ui-input-money.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dap-ui-input-money.vue","sourceRoot":"packages/components/form/input-money","sourcesContent":["<!--\n * @Author: DevinShi\n * @Date: 2020-02-06 10:37:47\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2020-02-26 14:26:06\n * @Description: file content description\n -->\n<template>\n  <div class=\"dap-ui-input-money dap-ui-form-item dap-ui-form-input\">\n    <a-form-item\n      :label-col=\"labelCol\"\n      :wrapper-col=\"wrapperCol\"\n      :has-feedback=\"hasFeedback\"\n      :validate-status=\"validateStatus\"\n      :extra=\"extra\"\n      :required=\"required\"\n      :colon=\"colon\"\n      :help=\"help\">\n      <template v-slot:label>\n        <span :style=\"{color: labelColor}\">{{label}}</span>\n      </template>\n      <a-input class=\"money\"\n        :value=\"data\"\n        @change=\"dataChangeEvent($event)\"\n        @blur=\"formatMoney($event)\"\n        @focus=\"deleteComma()\"\n        :placeholder=\"placeholder\" \n        :defaultValue=\"defaultValue\"\n        :disabled=\"disabled\"\n        :allowClear=\"allowClear\" />\n    </a-form-item>\n  </div>\n</template>\n<script>\nimport InputComponentMixin from '../../../mixins/input-component-mixin.js';\nimport BasicComponentMixin from '../../../mixins/basic-component-mixin.js';\n\nexport default {\n  name: \"DapUiInputMoney\",\n  type: 'FORM_INPUT',\n  mixins: [InputComponentMixin, BasicComponentMixin],\n  computed: {\n  \n  },\n  props: {\n  },\n  data() {\n    return {\n      data: \"\", // 需求为失焦格式化，所以要用data做中间数据，而不是直接用父组件的value\n      flag: false // flag 用于判断是否需要格式化金额，为false时格式化\n    }\n  },\n  watch: {\n    value : {\n      handler (newValue, oldValue) {\n        if (!this.flag) {\n          if (parseFloat(newValue) === 0) {\n            this.data = \"0.00\";\n          } else {\n            if (newValue) {\n              this.data = this.formatThousandth(newValue.toString(), 2, true);\n            }\n            \n          }\n        }\n      },\n      immediate:true,\n    }\n  },\n  methods: {\n    /**\n     * @author lizhihang\n     * @param e event\n     * @description 值改变事件，只允许输入数字相关\n     * @date 2020-2-26\n     */\n    dataChangeEvent(e) {\n      const { value } = e.target;\n      const reg = /^-?(0|[1-9][0-9]*)(\\.[0-9]*)?$/; // 数字正则\n      if ((!isNaN(value) && reg.test(value)) || value === '' || value === '-') {\n        if (value === '') { // 如果值为空 提示校验文字，不为空时另value为0 关闭校验文字，在失焦事件时将value在复制成正确的值\n          this.flag = false;\n          this.$formEventEmit('change', undefined);\n        } else {\n          this.flag = true;\n          this.$formEventEmit('change', 0);\n        }\n        this.data = value; \n      } else {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    },\n    /**\n     * @author lizhihang\n     * @param e event\n     * @description 失焦事件，改变父组件传来的value值\n     * @date 2019-2-26\n     */\n    formatMoney(e) {\n      const { value } = e.target;\n      this.flag = false;\n      if (!value || value === \"-\") {\n        this.$formEventEmit('change', undefined);\n        this.data = \"\";\n      } else if (parseFloat(value) === 0) {\n        this.$formEventEmit('change', 0);\n        this.data = \"0.00\"\n      } else {\n        var formatedMoney = this.formatThousandth(value, 2, true);\n        this.data = formatedMoney;\n        formatedMoney = formatedMoney.replace(/\\,/g, '');\n        this.$formEventEmit('change', parseFloat(formatedMoney));\n      }\n    },\n    /**\n     * @author lizhihang\n     * @description fous事件，去除逗号\n     * @date 2020-2-26\n     */\n    deleteComma() {\n      this.data = this.data.replace(/\\,/g, '');\n    },\n    formatThousandth(num, cent, isThousand) {\n      const reg = /\\d{1,3}(?=(\\d{3})+$)/g;\n      let result;\n      if (num || num === 0) {\n        num = num.toString().replace(/$|,/g, \"\");\n        const dotIndex = num.indexOf(\".\");\n        if (dotIndex > -1) {\n          let dotLeft = num.substring(0, dotIndex);\n          if (isThousand) {\n            dotLeft = (dotLeft + \"\").replace(reg, \"$&,\");\n          }\n          let dotRight = num.substring(dotIndex + 1, dotIndex + cent + 1);\n          if (dotRight.length < cent) {\n            while (dotRight.length < cent) {\n              dotRight += \"0\";\n            }\n          }\n          result = `${dotLeft}.${dotRight}`;\n        } else {\n          if (isThousand) {\n            result = (num + \"\").replace(reg, \"$&,\");\n          } else {\n            result = num;\n          }\n          if (cent > 0) {\n            result += \".\";\n            for (let i = 0; i < cent; i++) {\n              result += \"0\";\n            }\n          }\n        }\n      }\n      return result;\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style src=\"./index.less\" lang=\"less\">\n</style>\n"]}]}