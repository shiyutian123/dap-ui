{"remainingRequest":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/form/dap-ui-basic-form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/form/dap-ui-basic-form.vue","mtime":1582637688171},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHZhbGlkYXRpb25NaXhpbiB9IGZyb20gJ3Z1ZWxpZGF0ZScKaW1wb3J0IHsgcmVxdWlyZWQgfSBmcm9tICd2dWVsaWRhdGUvbGliL3ZhbGlkYXRvcnMnCmltcG9ydCBWYWxpZGF0ZVV0aWwgZnJvbSAnLi4vLi4vLi4vdXRpbHMvdmFsaWRhdGUudXRpbC5qcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRGFwVWlCYXNpY0Zvcm0iLAogIG1vZGVsOiB7CiAgICBwcm9wOiAnZm9ybURhdGEnLAogICAgZXZlbnQ6ICdjaGFuZ2UnCiAgfSwKICBtaXhpbnM6IFt2YWxpZGF0aW9uTWl4aW5dLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VycmVudEZvcm1EYXRhOiB7fSwKICAgICAgY2hpbGRyZW5WYWxpZGF0ZToge30KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB2aXNpYWJsZUZvcm1Db25maWc6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5mb3JtQ29uZmlnLmZpbHRlcihpdGVtQ29uZmlnID0+IHsKICAgICAgICByZXR1cm4gaXRlbUNvbmZpZyAmJiBpdGVtQ29uZmlnLnZpc2lhYmxlOwogICAgICB9KQogICAgfQogIH0sCiAgLy8g5re75Yqg6aqM6K+B5ZmoCiAgdmFsaWRhdGlvbnMoKSB7CiAgICBjb25zdCBjdXJyZW50Rm9ybURhdGEgPSB7fTsKICAgIGZvciAobGV0IGl0ZW1Db25maWcgb2YgdGhpcy5mb3JtQ29uZmlnKSB7CiAgICAgIGlmIChpdGVtQ29uZmlnLnJlcXVpcmVkKSB7CiAgICAgICAgY3VycmVudEZvcm1EYXRhW2l0ZW1Db25maWcuZGF0YUNvZGVdID0gewogICAgICAgICAgcmVxdWlyZWQKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VycmVudEZvcm1EYXRhW2l0ZW1Db25maWcuZGF0YUNvZGVdID0ge30KICAgICAgfQogICAgfQogICAgcmV0dXJuIHsKICAgICAgY3VycmVudEZvcm1EYXRhOiBjdXJyZW50Rm9ybURhdGEKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgICAgZm9ybVZhbHVlVHJhbnNDaGFuZ2UodHJhbnNEYXRhQ29kZSwgdmFsdWUpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy5jdXJyZW50Rm9ybURhdGEsIHRyYW5zRGF0YUNvZGUsIHZhbHVlKTsKICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCB0aGlzLmN1cnJlbnRGb3JtRGF0YSk7CiAgICAgIH0sCiAgICAgIGZvcm1WYWx1ZUNoYW5nZShkYXRhQ29kZSwgdmFsdWUpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy5jdXJyZW50Rm9ybURhdGEsIGRhdGFDb2RlLCB2YWx1ZSk7CiAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJywgdGhpcy5jdXJyZW50Rm9ybURhdGEpOwogICAgICAgIHRoaXMuJHYuY3VycmVudEZvcm1EYXRhW2RhdGFDb2RlXS4kdG91Y2goKTsKICAgICAgfSwKICAgICAgdmFsaWRhdGVDaGFuZ2UodXVpZCwgdmFsdWUpIHsKICAgICAgICB0aGlzLmNoaWxkcmVuVmFsaWRhdGVbdXVpZF0gPSB2YWx1ZTsKICAgICAgfSwKICAgICAgZ2V0VmFsaWRhdGVFcnJvcigpIHsKICAgICAgICBsZXQgdmFsaWRhdGVBcnJheSA9IFtdOwogICAgICAgIHZhbGlkYXRlQXJyYXkucHVzaCh0aGlzLiR2KTsKICAgICAgICB2YWxpZGF0ZUFycmF5ID0gWwogICAgICAgICAgLi4udmFsaWRhdGVBcnJheSwKICAgICAgICAgIC4uLk9iamVjdC52YWx1ZXModGhpcy5jaGlsZHJlblZhbGlkYXRlKQogICAgICAgIF07CiAgICAgICAgcmV0dXJuIFZhbGlkYXRlVXRpbC5tZXJnZVZhbGlkYXRlKHZhbGlkYXRlQXJyYXkpOwogICAgICB9LAogICAgICB2YWxpZGF0ZVRvdWNoKCkgewogICAgICAgIHRoaXMuJHYuJHRvdWNoKCk7CiAgICAgICAgdGhpcy5mb3JtQ29uZmlnLmZvckVhY2goaXRlbUNvbmZpZyA9PiB7CiAgICAgICAgICBpZiAodGhpcy4kYmFzZUZvcm1SZWdpc3Rlci5nZXRDb21wb25lbnRUeXBlKGl0ZW1Db25maWcuY29tcG9uZW50TmFtZSkgPT09ICdGT1JNX0xBWU9VVCcpIHsKICAgICAgICAgICAgaWYgKCB0aGlzLiRyZWZzW2l0ZW1Db25maWcudXVpZF0gJiYgIHRoaXMuJHJlZnNbaXRlbUNvbmZpZy51dWlkXVswXSkgewogICAgICAgICAgICAgIHRoaXMuJHJlZnNbaXRlbUNvbmZpZy51dWlkXVswXS52YWxpZGF0ZVRvdWNoKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9LAogICAgICByZXNldEZvcm0oKSB7CiAgICAgICAgdGhpcy4kdi4kcmVzZXQoKTsKICAgICAgICB0aGlzLmZvcm1Db25maWcuZm9yRWFjaChpdGVtQ29uZmlnID0+IHsKICAgICAgICAgIGlmICh0aGlzLiRiYXNlRm9ybVJlZ2lzdGVyLmdldENvbXBvbmVudFR5cGUoaXRlbUNvbmZpZy5jb21wb25lbnROYW1lKSA9PT0gJ0ZPUk1fTEFZT1VUJykgewogICAgICAgICAgICBpZiAoIHRoaXMuJHJlZnNbaXRlbUNvbmZpZy51dWlkXSAmJiAgdGhpcy4kcmVmc1tpdGVtQ29uZmlnLnV1aWRdWzBdKSB7CiAgICAgICAgICAgICAgdGhpcy4kcmVmc1tpdGVtQ29uZmlnLnV1aWRdWzBdLnJlc2V0Rm9ybSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAvLyB0aGlzLmN1cnJlbnRGb3JtRGF0YSA9IHRoaXMuZm9ybURhdGE7CiAgICAgIH0sCiAgICAgIC8qKgogICAgICAgKiDooajljZXkuovku7boh6rliqjop6blj5EKICAgICAgICovCiAgICAgIGZvcm1FdmVudEVtaXQoJGV2ZW50KSB7CiAgICAgICAgLy8g6KGo5Y2V5LqL5Lu25Y+R6YCBCiAgICAgICAgdGhpcy4kYmFzZUZvcm1SZWdpc3Rlci5leGN1dGVBZGFwdGVyRXZlbnQoJGV2ZW50LmNvbXBvbmVudE5hbWUsICRldmVudCwgdGhpcy5mb3JtQ29uZmlnLCB0aGlzLmdsb2JhbEZvcm1JbmZvLCB0aGlzLmZvcm1EYXRhKQogICAgICAgIHRoaXMuJGVtaXQoJ2Zvcm1FdmVudEVtaXQnLCAkZXZlbnQpOwogICAgICB9CiAgfSwKICB3YXRjaDogewogICAgZm9ybURhdGE6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24obmV3VmFsLG9sZFZhbCkgewogICAgICAgIGlmICh0aGlzLmN1cnJlbnRGb3JtRGF0YSAhPT0gbmV3VmFsICYmIG5ld1ZhbCkgewogICAgICAgICAgdGhpcy5jdXJyZW50Rm9ybURhdGEgPSBuZXdWYWwgOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfQogIH0sCiAgcHJvcHM6IHsKICAgIGZvcm1EYXRhOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDoge30KICAgIH0sCiAgICBmb3JtQ29uZmlnOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiBbXQogICAgfSwKICAgIGdsb2JhbEZvcm1JbmZvOiB7CgogICAgfSwKICAgIHZhbGlkYXRlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmN1cnJlbnRGb3JtRGF0YSA9IHRoaXMuZm9ybURhdGEgOwogIH0KfQo="},{"version":3,"sources":["dap-ui-basic-form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dap-ui-basic-form.vue","sourceRoot":"packages/components/form/form","sourcesContent":["<!--\n * @Author: DevinShi\n * @Date: 2020-02-06 10:37:47\n * @LastEditors: DevinShi\n * @LastEditTime: 2020-02-25 13:32:04\n * @Description: file content description\n -->\n<template>\n  <!-- 表单渲染，支持JSON Schema格式的渲染方式 -->\n  <div class=\"dap-ui-basic-form dap-ui-form\">\n      <dap-ui-basic-form-item\n        :rowSpan=\"itemConfig.rowSpan\"\n        :colSpan=\"itemConfig.colSpan\"\n        :uuid=\"itemConfig.uuid\"\n        v-for=\"itemConfig of visiableFormConfig\"\n        :key=\"itemConfig.uuid\">\n          <component\n            v-if=\"itemConfig.visiable && $baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_INPUT'\"\n            :has-feedback=\"false\"\n            :label-color=\"itemConfig.labelColor\"\n            :validate-status=\"$v.currentFormData[itemConfig.dataCode].$dirty && $v.currentFormData[itemConfig.dataCode].$error ? 'error' : 'success'\"\n            :help=\"$v.currentFormData[itemConfig.dataCode].$dirty && $v.currentFormData[itemConfig.dataCode].$error ? itemConfig.label + '为必填' : undefined\"\n            :required=\"itemConfig.required\"\n            :is=\"itemConfig.componentName\"\n            :label=\"itemConfig.label\"\n            :value=\"currentFormData[itemConfig.dataCode]\"\n            :transValue.sync=\"currentFormData[itemConfig.transDataCode]\"\n            :uuid=\"itemConfig.uuid\"\n            :options=\"itemConfig.options\"\n            :disabled=\"itemConfig.disabled\"\n            :placeholder=\"itemConfig.placeholder\"\n            :componentName=\"itemConfig.componentName\"\n            :columns=\"itemConfig.columnSet\"\n            :extraProp=\"itemConfig.extraProp\"\n            :multi=\"itemConfig.multi\"\n            @formEventEmit=\"formEventEmit($event)\"\n            @updateTransValue=\"formValueTransChange(itemConfig.transDataCode, $event)\"\n            @change=\"formValueChange(itemConfig.dataCode, $event)\"></component>\n          \n          <component\n            :label=\"itemConfig.label\"\n            v-if=\"itemConfig.visiable && $baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_STATIC_RENDER'\"\n            :is=\"itemConfig.componentName\"\n            :uuid=\"itemConfig.uuid\"\n            :componentName=\"itemConfig.componentName\"\n            @formEventEmit=\"formEventEmit($event)\"\n            :label-color=\"itemConfig.labelColor\"></component>\n\n          <component\n            :ref=\"itemConfig.uuid\"\n            v-if=\"itemConfig.visiable && $baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_LAYOUT'\"  \n            v-model=\"currentFormData\"\n            @validate=\"validateChange(itemConfig.uuid, $event)\"\n            :layoutConfig=\"itemConfig\"\n            :uuid=\"itemConfig.uuid\"\n            :componentName=\"itemConfig.componentName\"\n            @formEventEmit=\"formEventEmit($event)\"\n            :is=\"itemConfig.componentName\"></component>\n\n            <a-empty \n                image=\"\"\n                v-if=\"!$baseFormRegister.getComponentType(itemConfig.componentName) || !$baseFormRegister.hasComponent(itemConfig.componentName)\">\n                <span slot=\"description\"> `{{itemConfig.componentName}}` 组件未注册 </span>\n            </a-empty>\n      </dap-ui-basic-form-item>\n  </div>\n</template>\n\n<script>\nimport { validationMixin } from 'vuelidate'\nimport { required } from 'vuelidate/lib/validators'\nimport ValidateUtil from '../../../utils/validate.util.js'\n\nexport default {\n  name: \"DapUiBasicForm\",\n  model: {\n    prop: 'formData',\n    event: 'change'\n  },\n  mixins: [validationMixin],\n  data: function() {\n    return {\n      currentFormData: {},\n      childrenValidate: {}\n    }\n  },\n  computed: {\n    visiableFormConfig: function() {\n      return this.formConfig.filter(itemConfig => {\n        return itemConfig && itemConfig.visiable;\n      })\n    }\n  },\n  // 添加验证器\n  validations() {\n    const currentFormData = {};\n    for (let itemConfig of this.formConfig) {\n      if (itemConfig.required) {\n        currentFormData[itemConfig.dataCode] = {\n          required\n        }\n      } else {\n        currentFormData[itemConfig.dataCode] = {}\n      }\n    }\n    return {\n      currentFormData: currentFormData\n    }\n  },\n  methods: {\n      formValueTransChange(transDataCode, value) {\n        this.$set(this.currentFormData, transDataCode, value);\n        this.$emit('change', this.currentFormData);\n      },\n      formValueChange(dataCode, value) {\n        this.$set(this.currentFormData, dataCode, value);\n        this.$emit('change', this.currentFormData);\n        this.$v.currentFormData[dataCode].$touch();\n      },\n      validateChange(uuid, value) {\n        this.childrenValidate[uuid] = value;\n      },\n      getValidateError() {\n        let validateArray = [];\n        validateArray.push(this.$v);\n        validateArray = [\n          ...validateArray,\n          ...Object.values(this.childrenValidate)\n        ];\n        return ValidateUtil.mergeValidate(validateArray);\n      },\n      validateTouch() {\n        this.$v.$touch();\n        this.formConfig.forEach(itemConfig => {\n          if (this.$baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_LAYOUT') {\n            if ( this.$refs[itemConfig.uuid] &&  this.$refs[itemConfig.uuid][0]) {\n              this.$refs[itemConfig.uuid][0].validateTouch();\n            }\n          }\n        })\n      },\n      resetForm() {\n        this.$v.$reset();\n        this.formConfig.forEach(itemConfig => {\n          if (this.$baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_LAYOUT') {\n            if ( this.$refs[itemConfig.uuid] &&  this.$refs[itemConfig.uuid][0]) {\n              this.$refs[itemConfig.uuid][0].resetForm();\n            }\n          }\n        })\n        // this.currentFormData = this.formData;\n      },\n      /**\n       * 表单事件自动触发\n       */\n      formEventEmit($event) {\n        // 表单事件发送\n        this.$baseFormRegister.excuteAdapterEvent($event.componentName, $event, this.formConfig, this.globalFormInfo, this.formData)\n        this.$emit('formEventEmit', $event);\n      }\n  },\n  watch: {\n    formData: {\n      handler: function(newVal,oldVal) {\n        if (this.currentFormData !== newVal && newVal) {\n          this.currentFormData = newVal ;\n        }\n      },\n      deep: true\n    }\n  },\n  props: {\n    formData: {\n      type: Object,\n      default: {}\n    },\n    formConfig: {\n      type: Array,\n      default: []\n    },\n    globalFormInfo: {\n\n    },\n    validate: {\n      type: Object,\n    }\n  },\n  created() {\n    this.currentFormData = this.formData ;\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style src=\"./index.less\" lang=\"less\">\n</style>\n"]}]}