{"remainingRequest":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/org-select/dap-ui-org-select.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/org-select/dap-ui-org-select.vue","mtime":1583521197285},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJbnB1dENvbXBvbmVudE1peGluIGZyb20gJy4uLy4uLy4uL21peGlucy9pbnB1dC1jb21wb25lbnQtbWl4aW4uanMnOwppbXBvcnQgQmFzaWNDb21wb25lbnRNaXhpbiBmcm9tICcuLi8uLi8uLi9taXhpbnMvYmFzaWMtY29tcG9uZW50LW1peGluLmpzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRGFwVWlPcmdTZWxlY3QiLAogIHR5cGU6ICdGT1JNX0lOUFVUJywKICBtaXhpbnM6IFtJbnB1dENvbXBvbmVudE1peGluLCBCYXNpY0NvbXBvbmVudE1peGluXSwKICBjb21wb25lbnRzOiB7fSwKICBwcm9wczogewogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNhbGNTZWxlY3RlZEFycmF5OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuZXh0cmFQcm9wLnNlbGVjdGVkQXJyYXkuc2xpY2UoMCwgdGhpcy5tdWx0Q291bnQpOwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG11bHRDb3VudDogMwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIC8vVE9ETzog5LiN5ZCI6YCC55qE5pa55qGICiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgaWYgKHRoaXMuZXh0cmFQcm9wLm1vZGUgPT09ICdjYXNjYWRlJykgewogICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoInF1ZXJ5LW9wdGlvbnMiKQogICAgICB9CiAgICB9LCAzMDApCiAgfSwKICB3YXRjaDogewogICAgInZhbHVlIjogewogICAgICBoYW5kbGVyKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgICAgaWYgKG5ld1ZhbCAmJiBuZXdWYWwubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICBpZiAodGhpcy5leHRyYVByb3AubW9kZSA9PT0gJ2Nhc2NhZGUnKSB7CiAgICAgICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoInF1ZXJ5LW9wdGlvbnMiKQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmV4dHJhUHJvcC5tb2RlID09PSAibW9kYWwiICYmIHRoaXMuZXh0cmFQcm9wLnNlbGVjdGVkQXJyYXkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoInF1ZXJ5LW9yZy1pbmZvIiwgbmV3VmFsKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9LAogICAgImV4dHJhUHJvcC5vcHRpb25zIjogewogICAgICBoYW5kbGVyKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgICAgaWYgKG5ld1ZhbCAmJiBuZXdWYWwubGVuZ3RoID4gMCkgewogICAgICAgICAgLy8gaWYgKHRoaXMuZXh0cmFQcm9wLnNlbGVjdFR5cGUgPT09ICJzaW5nbGUiKSB7CiAgICAgICAgICAvLyAgIHRoaXMuc2VsZWN0ZWRDb2RlQXJyYXkgPSB0aGlzLnZhbHVlCiAgICAgICAgICAvLyB9IGVsc2UgaWYgKHRoaXMuZXh0cmFQcm9wLnNlbGVjdFR5cGUgPT09ICJtdWx0IikgewogICAgICAgICAgLy8gICB0aGlzLnNlbGVjdGVkQ29kZUFycmF5ID0gdGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFycmF5ID8gdGhpcy52YWx1ZSA6IFt0aGlzLnZhbHVlXQogICAgICAgICAgLy8gfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICJleHRyYVByb3Auc2VsZWN0ZWRBcnJheSI6IHsKICAgICAgaGFuZGxlcihuZXdWYWwsIG9sZFZhbCkgewogICAgICAgIGlmIChuZXdWYWwubGVuZ3RoID4gMCAmJiB0aGlzLmV4dHJhUHJvcC5tb2RlID09PSAibW9kYWwiKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhuZXdWYWwpOwogICAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2UoKQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHt9LAogIG1ldGhvZHM6IHsKICAgIG9uRHJvcGRvd25WaXNpYmxlQ2hhbmdlKHZpc2libGUpIHsKICAgICAgaWYgKHZpc2libGUpIHsKICAgICAgICBkZWJ1Z2dlcgogICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoInF1ZXJ5LW9wdGlvbnMiKQogICAgICB9CiAgICB9LAogICAgaGFuZGxlU2VsZWN0KHZhbHVlKSB7CiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmV4dHJhUHJvcC5vcHRpb25zLmZpbmQoaXRlbSA9PiBpdGVtLmNvZGUgPT09IHZhbHVlKQogICAgICBpZiAodmFsdWUgJiYgaXRlbSkgewogICAgICAgIGlmICh0aGlzLmV4dHJhUHJvcC5zZWxlY3RUeXBlID09PSAic2luZ2xlIikgewogICAgICAgICAgdGhpcy5leHRyYVByb3Auc2VsZWN0ZWRBcnJheS5wb3AoKQogICAgICAgIH0KICAgICAgICB0aGlzLmV4dHJhUHJvcC5zZWxlY3RlZEFycmF5LnB1c2goaXRlbSkKICAgICAgfQogICAgICBpZiAodGhpcy5leHRyYVByb3Auc2VsZWN0ZWRBcnJheS5sZW5ndGggPiB0aGlzLm11bHRDb3VudCkgewogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIGxldCBub2RlcyA9IHRoaXMuJHJlZnMuY2FzY2FkZVNlbGVjdC4kZWwucXVlcnlTZWxlY3RvckFsbCgiLmFudC1zZWxlY3Qtc2VsZWN0aW9uX19jaG9pY2UiKQogICAgICAgICAgbGV0IGxhc3ROb2RlID0gbm9kZXNbbm9kZXMubGVuZ3RoIC0gMV0KICAgICAgICAgIGxhc3ROb2RlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd0cmFuc3BhcmVudCcKICAgICAgICAgIGxhc3ROb2RlLnN0eWxlLmJvcmRlciA9IDAKICAgICAgICAgIGxhc3ROb2RlLnN0eWxlLnBhZGRpbmcgPSAwCiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIGhhbmRsZUNsaWNrKCkgewogICAgICBpZiAodGhpcy5leHRyYVByb3Auc2VsZWN0VHlwZSA9PT0gInNpbmdsZSIgJiYgdGhpcy5leHRyYVByb3AubW9kZSA9PT0gIm1vZGFsIikgewogICAgICAgIHRoaXMuJGVtaXQoIm9wZW4tbW9kYWwiKQogICAgICB9CiAgICB9LAogICAgaGFuZGxlQ2xvc2Uob3JnKSB7CiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5leHRyYVByb3Auc2VsZWN0ZWRBcnJheS5maW5kSW5kZXgoX29yZyA9PiBfb3JnLmNvZGUgPT09IG9yZy5jb2RlKQogICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgdGhpcy5leHRyYVByb3Auc2VsZWN0ZWRBcnJheS5zcGxpY2UoaW5kZXgsIDEpCiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2UoKQogICAgICB9CiAgICB9LAogICAgaGFuZGxlT3Blbk1vZGFsKCkgewogICAgICB0aGlzLiRlbWl0KCJvcGVuLW1vZGFsIikKICAgIH0sCiAgICBlbWl0VmFsdWVDaGFuZ2UoKSB7CiAgICAgIGlmICh0aGlzLmV4dHJhUHJvcC5zZWxlY3RUeXBlID09PSAic2luZ2xlIikgewogICAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoImNoYW5nZSIsIHRoaXMuZXh0cmFQcm9wLnNlbGVjdGVkQXJyYXkubWFwKG9yZyA9PiBvcmcuY29kZSlbMF0pCiAgICAgIH0gZWxzZSBpZiAodGhpcy5leHRyYVByb3Auc2VsZWN0VHlwZSA9PT0gIm11bHQiKSB7CiAgICAgICAgdGhpcy4kZm9ybUV2ZW50RW1pdCgiY2hhbmdlIiwgdGhpcy5leHRyYVByb3Auc2VsZWN0ZWRBcnJheS5tYXAob3JnID0+IG9yZy5jb2RlKSkKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["dap-ui-org-select.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dap-ui-org-select.vue","sourceRoot":"packages/components/form/org-select","sourcesContent":["<!--\n * @Author: DevinShi\n * @Date: 2020-02-06 10:37:47\n * @LastEditors: DevinShi\n * @LastEditTime: 2020-02-18 11:01:33\n * @Description: file content description\n -->\n<template>\n  <div class=\"dap-ui-org-select dap-ui-form-item dap-ui-form-input\">\n    <a-form-item\n      :label-col=\"labelCol\"\n      :wrapper-col=\"wrapperCol\"\n      :has-feedback=\"hasFeedback\"\n      :validate-status=\"validateStatus\"\n      :extra=\"extra\"\n      :required=\"required\"\n      :colon=\"colon\"\n      :help=\"help\">\n      <template v-slot:label>\n        <span :style=\"{color: labelColor}\">{{label}}</span>\n      </template>\n      <template v-if=\"extraProp.mode === 'modal'\">\n        <div \n          class=\"display-block\" \n          :class=\"{'display-block-error': validateStatus === 'error'}\" \n          tabindex = \"0\" \n          @click=\"handleClick\"\n        >\n          <template v-if=\"extraProp.selectType === 'single'\">\n            <div class=\"display-block-placeholder\" v-if=\"extraProp.selectType === 'single' && extraProp.selectedArray.length === 0\">\n              {{ placeholder }}\n            </div>\n            <div class=\"display-block-single\" v-if=\"extraProp.selectedArray[0]\">\n              <span>{{ extraProp.selectedArray[0].name }}</span>\n            </div>\n            <div class=\"display-block-single-icon\">\n              <a-button shape=\"circle\">\n                <a-icon :type=\"extraProp.selectedArray.length ? 'swap' : 'apartment'\"></a-icon>\n              </a-button>\n            </div>\n          </template>\n          <template v-if=\"extraProp.selectType === 'mult'\">\n            <template v-for=\"org in calcSelectedArray\">\n              <a-tag :closable=\"true\" @close=\"handleClose(org)\">{{ org.name }}</a-tag>\n            </template>\n            <div class=\"display-block-more-item\" v-if=\"extraProp.selectedArray.length > multCount\">\n              <a-tooltip :title=\"'共选: ' + extraProp.selectedArray.length + '组织'\">\n                <a-button shape=\"circle\">\n                  <a-icon type=\"small-dash\"></a-icon>\n                </a-button>\n              </a-tooltip>\n            </div>\n            <div class=\"display-block-mult-add-item\">\n              <a-button shape=\"circle\" @click=\"handleOpenModal\">\n                <a-icon type=\"plus\"></a-icon>\n              </a-button>\n            </div>\n          </template>\n        </div>\n      </template>\n      <template v-if=\"extraProp.mode === 'cascade'\">\n        <a-select\n          ref=\"cascadeSelect\"\n          :value=\"value\"\n          @change=\"$formEventEmit('change', $event)\"\n          :mode=\"extraProp.selectType === 'mult' ? 'multiple' : 'default'\"\n          :maxTagCount=\"multCount\"\n          :placeholder=\"placeholder\"\n          :disabled=\"disabled\"\n          @dropdownVisibleChange=\"onDropdownVisibleChange\"\n          @select=\"handleSelect\"\n        >\n          <template slot=\"maxTagPlaceholder\">\n            <div class=\"display-block-more-item\" v-if=\"extraProp.selectedArray.length > multCount\">\n              <a-tooltip :title=\"'共选: ' + extraProp.selectedArray.length + '组织'\">\n                <a-button shape=\"circle\">\n                  <a-icon type=\"small-dash\"></a-icon>\n                </a-button>\n              </a-tooltip>\n            </div>\n          </template>\n          <template v-for=\"option in extraProp.options\">\n            <a-select-option :value=\"option.code\" :key=\"option.key\">{{ option.name }}</a-select-option>\n          </template>\n        </a-select>\n      </template>\n    </a-form-item>\n  </div>\n</template>\n<script>\nimport InputComponentMixin from '../../../mixins/input-component-mixin.js';\nimport BasicComponentMixin from '../../../mixins/basic-component-mixin.js';\n\nexport default {\n  name: \"DapUiOrgSelect\",\n  type: 'FORM_INPUT',\n  mixins: [InputComponentMixin, BasicComponentMixin],\n  components: {},\n  props: {\n  },\n  computed: {\n    calcSelectedArray: function() {\n      return this.extraProp.selectedArray.slice(0, this.multCount);\n    }\n  },\n  data() {\n    return {\n      multCount: 3\n    }\n  },\n  mounted() {\n    //TODO: 不合适的方案\n    setTimeout(() => {\n      if (this.extraProp.mode === 'cascade') {\n        this.$formEventEmit(\"query-options\")\n      }\n    }, 300)\n  },\n  watch: {\n    \"value\": {\n      handler(newVal, oldVal) {\n        if (newVal && newVal.length !== 0) {\n          if (this.extraProp.mode === 'cascade') {\n            this.$formEventEmit(\"query-options\")\n          } else if (this.extraProp.mode === \"modal\" && this.extraProp.selectedArray.length === 0) {\n            this.$formEventEmit(\"query-org-info\", newVal)\n          }\n        }\n      },\n      immediate: true\n    },\n    \"extraProp.options\": {\n      handler(newVal, oldVal) {\n        if (newVal && newVal.length > 0) {\n          // if (this.extraProp.selectType === \"single\") {\n          //   this.selectedCodeArray = this.value\n          // } else if (this.extraProp.selectType === \"mult\") {\n          //   this.selectedCodeArray = this.value instanceof Array ? this.value : [this.value]\n          // }\n        }\n      }\n    },\n    \"extraProp.selectedArray\": {\n      handler(newVal, oldVal) {\n        if (newVal.length > 0 && this.extraProp.mode === \"modal\") {\n          console.log(newVal);\n          this.emitValueChange()\n        }\n      }\n    }\n  },\n  created() {},\n  methods: {\n    onDropdownVisibleChange(visible) {\n      if (visible) {\n        debugger\n        this.$formEventEmit(\"query-options\")\n      }\n    },\n    handleSelect(value) {\n      const item = this.extraProp.options.find(item => item.code === value)\n      if (value && item) {\n        if (this.extraProp.selectType === \"single\") {\n          this.extraProp.selectedArray.pop()\n        }\n        this.extraProp.selectedArray.push(item)\n      }\n      if (this.extraProp.selectedArray.length > this.multCount) {\n        this.$nextTick(() => {\n          let nodes = this.$refs.cascadeSelect.$el.querySelectorAll(\".ant-select-selection__choice\")\n          let lastNode = nodes[nodes.length - 1]\n          lastNode.style.backgroundColor = 'transparent'\n          lastNode.style.border = 0\n          lastNode.style.padding = 0\n        })\n      }\n    },\n    handleClick() {\n      if (this.extraProp.selectType === \"single\" && this.extraProp.mode === \"modal\") {\n        this.$emit(\"open-modal\")\n      }\n    },\n    handleClose(org) {\n      const index = this.extraProp.selectedArray.findIndex(_org => _org.code === org.code)\n      if (index !== -1) {\n        this.extraProp.selectedArray.splice(index, 1)\n        this.emitValueChange()\n      }\n    },\n    handleOpenModal() {\n      this.$emit(\"open-modal\")\n    },\n    emitValueChange() {\n      if (this.extraProp.selectType === \"single\") {\n        this.$formEventEmit(\"change\", this.extraProp.selectedArray.map(org => org.code)[0])\n      } else if (this.extraProp.selectType === \"mult\") {\n        this.$formEventEmit(\"change\", this.extraProp.selectedArray.map(org => org.code))\n      }\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style src=\"./index.less\" lang=\"less\">\n</style>\n"]}]}