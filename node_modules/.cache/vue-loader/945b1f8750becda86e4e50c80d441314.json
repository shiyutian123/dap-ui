{"remainingRequest":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/lov/dap-ui-lov.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/lov/dap-ui-lov.vue","mtime":1582480097284},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJbnB1dENvbXBvbmVudE1peGluIGZyb20gJy4uLy4uLy4uL21peGlucy9pbnB1dC1jb21wb25lbnQtbWl4aW4uanMnOwppbXBvcnQgQmFzaWNDb21wb25lbnRNaXhpbiBmcm9tICcuLi8uLi8uLi9taXhpbnMvYmFzaWMtY29tcG9uZW50LW1peGluLmpzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRGFwVWlMb3YnLAogIHR5cGU6ICdGT1JNX0lOUFVUJywKICBtaXhpbnM6IFtJbnB1dENvbXBvbmVudE1peGluLCBCYXNpY0NvbXBvbmVudE1peGluXSwKICBwcm9wczogewogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1vZGFsQ29uZmlnOiB7CiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgdGl0bGU6ICfmlbDmja7pgInmi6knLAogICAgICAgIHNpemU6ICdtZWRpdW0nLAogICAgICAgIG1vZGFsQ2xhc3M6ICdkYXAtdWktbG92LW1vZGFsJwogICAgICB9LAogICAgICBsb3ZUYWJsZUJhc2VDb25maWc6IHsKICAgICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgICBzZWxlY3RNb2RlOiAic2luZ2xlIiwKICAgICAgICB2aXJ0dWFsTGlzdDogdHJ1ZSwKICAgICAgICBjb2x1bW5zOiBbXSwKICAgICAgICB0YWJsZVBhZ2U6IHsKICAgICAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgICAgdG90YWxSZXN1bHQ6IDAKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNlYXJjaFN0cjogJycsCiAgICAgIGNoZWNrZWREYXRhOiBbXQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgb25DbGlja0xvdklucHV0KGUpIHsKICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5tb2RhbENvbmZpZy52aXNpYmxlID0gdHJ1ZTsKICAgICAgICB0aGlzLiRmb3JtRXZlbnRFbWl0KCdxdWVyeS1sb3YtZGF0YScsIHsKICAgICAgICAgIGN1cnJlbnRQYWdlOiB0aGlzLmxvdlRhYmxlQmFzZUNvbmZpZy50YWJsZVBhZ2UuY3VycmVudFBhZ2UsCiAgICAgICAgICBwYWdlU2l6ZTogdGhpcy5sb3ZUYWJsZUJhc2VDb25maWcudGFibGVQYWdlLnBhZ2VTaXplCiAgICAgICAgfSk7CiAgICAgICAgLy8g6K6h566X6KGo5qC86auY5bqmCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGFwLXVpLWxvdi1tb2RhbCAubG92LWNob29zZS1ibG9jaycpLmNsaWVudEhlaWdodCAtIDg4OwogICAgICAgICAgdGhpcy5sb3ZUYWJsZUJhc2VDb25maWcubWF4SGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDsKICAgICAgICB9LCA2MCk7CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVPayhlKSB7CiAgICAgIHRoaXMuZXh0cmFQcm9wLnRhYmxlRGF0YSA9IFtdOwogICAgICB0aGlzLnJlc2V0VGFibGVQYWdlKCk7CiAgICAgIHRoaXMubW9kYWxDb25maWcudmlzaWJsZSA9IGZhbHNlOwogICAgICBjb25zdCBkYXRhID0gewogICAgICAgIHNlbGVjdGlvbjogdGhpcy5jaGVja2VkRGF0YQogICAgICB9OwogICAgICB0aGlzLiRmb3JtRXZlbnRFbWl0KCdsb3Ytb2snLCBkYXRhKQogICAgfSwKICAgIGhhbmRsZUNhbmNlbChlKSB7CiAgICAgIHRoaXMucmVzZXRUYWJsZVBhZ2UoKTsKICAgICAgdGhpcy5tb2RhbENvbmZpZy52aXNpYmxlID0gZmFsc2U7CiAgICB9LAogICAgcmVzZXRUYWJsZVBhZ2UoKSB7CiAgICAgIHRoaXMubG92VGFibGVCYXNlQ29uZmlnLnRhYmxlUGFnZS5jdXJyZW50UGFnZSA9IDE7CiAgICAgIHRoaXMubG92VGFibGVCYXNlQ29uZmlnLnRhYmxlUGFnZS5wYWdlU2l6ZSA9IDEwOwogICAgfSwKICAgIGhhbmRsZVBhZ2VDaGFuZ2UoZSkgewogICAgICB0aGlzLmxvdlRhYmxlQmFzZUNvbmZpZy50YWJsZVBhZ2UuY3VycmVudFBhZ2UgPSBlLmN1cnJlbnRQYWdlOwogICAgICB0aGlzLmxvdlRhYmxlQmFzZUNvbmZpZy50YWJsZVBhZ2UucGFnZVNpemUgPSBlLnBhZ2VTaXplOwogICAgICB0aGlzLiRmb3JtRXZlbnRFbWl0KCdxdWVyeS1sb3YtZGF0YScsIHsKICAgICAgICBjdXJyZW50UGFnZTogdGhpcy5sb3ZUYWJsZUJhc2VDb25maWcudGFibGVQYWdlLmN1cnJlbnRQYWdlLAogICAgICAgIHBhZ2VTaXplOiB0aGlzLmxvdlRhYmxlQmFzZUNvbmZpZy50YWJsZVBhZ2UucGFnZVNpemUsCiAgICAgICAgc2VhcmNoU3RyOiB0aGlzLnNlYXJjaFN0cgogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVTZWxlY3RDaGFuZ2UoZSkgewogICAgICB0aGlzLmNoZWNrZWREYXRhID0gZS5zZWxlY3Rpb247CiAgICB9LAogICAgb25TZWFyY2goc2VhcmNoU3RyKSB7CiAgICAgIHRoaXMuc2VhcmNoU3RyID0gc2VhcmNoU3RyOwogICAgICB0aGlzLnJlc2V0VGFibGVQYWdlKCk7CiAgICAgIHRoaXMuJGZvcm1FdmVudEVtaXQoJ3F1ZXJ5LWxvdi1kYXRhJywgewogICAgICAgIGN1cnJlbnRQYWdlOiB0aGlzLmxvdlRhYmxlQmFzZUNvbmZpZy50YWJsZVBhZ2UuY3VycmVudFBhZ2UsCiAgICAgICAgcGFnZVNpemU6IHRoaXMubG92VGFibGVCYXNlQ29uZmlnLnRhYmxlUGFnZS5wYWdlU2l6ZSwKICAgICAgICBzZWFyY2hTdHI6IHRoaXMuc2VhcmNoU3RyCiAgICAgIH0pOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICdleHRyYVByb3AudG90YWxSZXN1bHQnOiB7CiAgICAgIGhhbmRsZXIobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbCAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIHRoaXMubG92VGFibGVCYXNlQ29uZmlnLnRhYmxlUGFnZS50b3RhbFJlc3VsdCA9IG5ld1ZhbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAnZXh0cmFQcm9wLmNvbHVtbnMnOiB7CiAgICAgIGhhbmRsZXIobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgICB0aGlzLmxvdlRhYmxlQmFzZUNvbmZpZy5jb2x1bW5zID0gbmV3VmFsOwogICAgICB9CiAgICB9LAogICAgJ2V4dHJhUHJvcC5sb2FkaW5nJzogewogICAgICBoYW5kbGVyKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgICAgdGhpcy5sb3ZUYWJsZUJhc2VDb25maWcubG9hZGluZyA9IG5ld1ZhbDsKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["dap-ui-lov.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dap-ui-lov.vue","sourceRoot":"packages/components/form/lov","sourcesContent":["<!--\n * @Author: your name\n * @Date: 2020-02-21 16:38:40\n * @LastEditTime: 2020-02-23 17:30:04\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /dap-vue-ui/packages/components/form/lov/dap-ui-lov.vue\n -->\n<template>\n  <div class=\"dap-ui-lov dap-ui-form-item dap-ui-form-input\">\n    <a-form-item\n      :label-col=\"labelCol\"\n      :wrapper-col=\"wrapperCol\"\n      :has-feedback=\"hasFeedback\"\n      :validate-status=\"validateStatus\"\n      :extra=\"extra\"\n      :required=\"required\"\n      :colon=\"colon\"\n      :help=\"help\">\n      <template v-slot:label>\n        <span :style=\"{color: labelColor}\">{{label}}</span>\n      </template>\n      <div\n      @click=\"onClickLovInput\">\n        <a-input\n        class=\"lov-input\"\n        :readonly=\"true\"\n        :value=\"value\"\n        :placeholder=\"placeholder\"\n        :defaultValue=\"defaultValue\"\n        :allowClear=\"allowClear\"\n        >\n          <a-icon slot=\"addonAfter\" type=\"search\" />\n        </a-input>\n      </div>\n    </a-form-item>\n    <dap-ui-modal\n    v-bind=\"modalConfig\"\n    @ok=\"handleOk\"\n    @cancel=\"handleCancel\">\n      <div class=\"lov-choose-block\">\n        <a-input-search :placeholder=\"placeholder\" @search=\"onSearch\">\n          <a-button type=\"primary\" slot=\"enterButton\">\n            <a-icon type=\"search\" />\n          </a-button>\n        </a-input-search>\n        <dap-ui-table\n        :table-base-config=\"lovTableBaseConfig\"\n        :table-data.sync=\"extraProp.tableData\"\n        @page-change=\"handlePageChange\"\n        @select-change=\"handleSelectChange\"\n        ></dap-ui-table>\n      </div>\n    </dap-ui-modal>\n  </div>\n</template>\n\n<script>\nimport InputComponentMixin from '../../../mixins/input-component-mixin.js';\nimport BasicComponentMixin from '../../../mixins/basic-component-mixin.js';\n\nexport default {\n  name: 'DapUiLov',\n  type: 'FORM_INPUT',\n  mixins: [InputComponentMixin, BasicComponentMixin],\n  props: {\n  },\n  data() {\n    return {\n      modalConfig: {\n        visible: false,\n        title: '数据选择',\n        size: 'medium',\n        modalClass: 'dap-ui-lov-modal'\n      },\n      lovTableBaseConfig: {\n        loading: false,\n        selectMode: \"single\",\n        virtualList: true,\n        columns: [],\n        tablePage: {\n          currentPage: 1,\n          pageSize: 10,\n          totalResult: 0\n        }\n      },\n      searchStr: '',\n      checkedData: []\n    }\n  },\n  methods: {\n    onClickLovInput(e) {\n      if (!this.disabled) {\n        this.modalConfig.visible = true;\n        this.$formEventEmit('query-lov-data', {\n          currentPage: this.lovTableBaseConfig.tablePage.currentPage,\n          pageSize: this.lovTableBaseConfig.tablePage.pageSize\n        });\n        // 计算表格高度\n        setTimeout(() => {\n          const height = document.querySelector('.dap-ui-lov-modal .lov-choose-block').clientHeight - 88;\n          this.lovTableBaseConfig.maxHeight = `${height}px`;\n        }, 60);\n      }\n    },\n    handleOk(e) {\n      this.extraProp.tableData = [];\n      this.resetTablePage();\n      this.modalConfig.visible = false;\n      const data = {\n        selection: this.checkedData\n      };\n      this.$formEventEmit('lov-ok', data)\n    },\n    handleCancel(e) {\n      this.resetTablePage();\n      this.modalConfig.visible = false;\n    },\n    resetTablePage() {\n      this.lovTableBaseConfig.tablePage.currentPage = 1;\n      this.lovTableBaseConfig.tablePage.pageSize = 10;\n    },\n    handlePageChange(e) {\n      this.lovTableBaseConfig.tablePage.currentPage = e.currentPage;\n      this.lovTableBaseConfig.tablePage.pageSize = e.pageSize;\n      this.$formEventEmit('query-lov-data', {\n        currentPage: this.lovTableBaseConfig.tablePage.currentPage,\n        pageSize: this.lovTableBaseConfig.tablePage.pageSize,\n        searchStr: this.searchStr\n      });\n    },\n    handleSelectChange(e) {\n      this.checkedData = e.selection;\n    },\n    onSearch(searchStr) {\n      this.searchStr = searchStr;\n      this.resetTablePage();\n      this.$formEventEmit('query-lov-data', {\n        currentPage: this.lovTableBaseConfig.tablePage.currentPage,\n        pageSize: this.lovTableBaseConfig.tablePage.pageSize,\n        searchStr: this.searchStr\n      });\n    }\n  },\n  watch: {\n    'extraProp.totalResult': {\n      handler(newVal, oldVal) {\n        if (typeof newVal !== 'undefined') {\n          this.lovTableBaseConfig.tablePage.totalResult = newVal;\n        }\n      }\n    },\n    'extraProp.columns': {\n      handler(newVal, oldVal) {\n        this.lovTableBaseConfig.columns = newVal;\n      }\n    },\n    'extraProp.loading': {\n      handler(newVal, oldVal) {\n        this.lovTableBaseConfig.loading = newVal;\n      }\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style src=\"./index.less\" lang=\"less\">\n</style>\n"]}]}