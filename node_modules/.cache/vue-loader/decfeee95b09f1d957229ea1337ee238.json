{"remainingRequest":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/form/dap-ui-basic-form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/packages/components/form/form/dap-ui-basic-form.vue","mtime":1582375992246},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/coder/project/04_dap/lerna-dap/packages/dap-vue-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHZhbGlkYXRpb25NaXhpbiB9IGZyb20gJ3Z1ZWxpZGF0ZScKaW1wb3J0IHsgcmVxdWlyZWQgfSBmcm9tICd2dWVsaWRhdGUvbGliL3ZhbGlkYXRvcnMnCmltcG9ydCBWYWxpZGF0ZVV0aWwgZnJvbSAnLi4vLi4vLi4vdXRpbHMvdmFsaWRhdGUudXRpbC5qcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRGFwVWlCYXNpY0Zvcm0iLAogIG1vZGVsOiB7CiAgICBwcm9wOiAnZm9ybURhdGEnLAogICAgZXZlbnQ6ICdjaGFuZ2UnCiAgfSwKICBtaXhpbnM6IFt2YWxpZGF0aW9uTWl4aW5dLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VycmVudEZvcm1EYXRhOiB7fSwKICAgICAgY2hpbGRyZW5WYWxpZGF0ZToge30KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB2aXNpYWJsZUZvcm1Db25maWc6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5mb3JtQ29uZmlnLmZpbHRlcihpdGVtQ29uZmlnID0+IHsKICAgICAgICByZXR1cm4gaXRlbUNvbmZpZyAmJiBpdGVtQ29uZmlnLnZpc2lhYmxlOwogICAgICB9KQogICAgfQogIH0sCiAgLy8g5re75Yqg6aqM6K+B5ZmoCiAgdmFsaWRhdGlvbnMoKSB7CiAgICBjb25zdCBjdXJyZW50Rm9ybURhdGEgPSB7fTsKICAgIGZvciAobGV0IGl0ZW1Db25maWcgb2YgdGhpcy5mb3JtQ29uZmlnKSB7CiAgICAgIGlmIChpdGVtQ29uZmlnLnJlcXVpcmVkKSB7CiAgICAgICAgY3VycmVudEZvcm1EYXRhW2l0ZW1Db25maWcuZGF0YUNvZGVdID0gewogICAgICAgICAgcmVxdWlyZWQKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VycmVudEZvcm1EYXRhW2l0ZW1Db25maWcuZGF0YUNvZGVdID0ge30KICAgICAgfQogICAgfQogICAgcmV0dXJuIHsKICAgICAgY3VycmVudEZvcm1EYXRhOiBjdXJyZW50Rm9ybURhdGEKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgICAgZm9ybVZhbHVlQ2hhbmdlKGRhdGFDb2RlLCB2YWx1ZSkgewogICAgICAgIHRoaXMuJHNldCh0aGlzLmN1cnJlbnRGb3JtRGF0YSwgZGF0YUNvZGUsIHZhbHVlKTsKICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCB0aGlzLmN1cnJlbnRGb3JtRGF0YSk7CiAgICAgICAgdGhpcy4kdi5jdXJyZW50Rm9ybURhdGFbZGF0YUNvZGVdLiR0b3VjaCgpOwogICAgICB9LAogICAgICB2YWxpZGF0ZUNoYW5nZSh1dWlkLCB2YWx1ZSkgewogICAgICAgIHRoaXMuY2hpbGRyZW5WYWxpZGF0ZVt1dWlkXSA9IHZhbHVlOwogICAgICB9LAogICAgICBnZXRWYWxpZGF0ZUVycm9yKCkgewogICAgICAgIGxldCB2YWxpZGF0ZUFycmF5ID0gW107CiAgICAgICAgdmFsaWRhdGVBcnJheS5wdXNoKHRoaXMuJHYpOwogICAgICAgIHZhbGlkYXRlQXJyYXkgPSBbCiAgICAgICAgICAuLi52YWxpZGF0ZUFycmF5LAogICAgICAgICAgLi4uT2JqZWN0LnZhbHVlcyh0aGlzLmNoaWxkcmVuVmFsaWRhdGUpCiAgICAgICAgXTsKICAgICAgICByZXR1cm4gVmFsaWRhdGVVdGlsLm1lcmdlVmFsaWRhdGUodmFsaWRhdGVBcnJheSk7CiAgICAgIH0sCiAgICAgIHZhbGlkYXRlVG91Y2goKSB7CiAgICAgICAgdGhpcy4kdi4kdG91Y2goKTsKICAgICAgICB0aGlzLmZvcm1Db25maWcuZm9yRWFjaChpdGVtQ29uZmlnID0+IHsKICAgICAgICAgIGlmICh0aGlzLiRiYXNlRm9ybVJlZ2lzdGVyLmdldENvbXBvbmVudFR5cGUoaXRlbUNvbmZpZy5jb21wb25lbnROYW1lKSA9PT0gJ0ZPUk1fTEFZT1VUJykgewogICAgICAgICAgICBpZiAoIHRoaXMuJHJlZnNbaXRlbUNvbmZpZy51dWlkXSAmJiAgdGhpcy4kcmVmc1tpdGVtQ29uZmlnLnV1aWRdWzBdKSB7CiAgICAgICAgICAgICAgdGhpcy4kcmVmc1tpdGVtQ29uZmlnLnV1aWRdWzBdLnZhbGlkYXRlVG91Y2goKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0sCiAgICAgIHJlc2V0Rm9ybSgpIHsKICAgICAgICB0aGlzLiR2LiRyZXNldCgpOwogICAgICAgIHRoaXMuZm9ybUNvbmZpZy5mb3JFYWNoKGl0ZW1Db25maWcgPT4gewogICAgICAgICAgaWYgKHRoaXMuJGJhc2VGb3JtUmVnaXN0ZXIuZ2V0Q29tcG9uZW50VHlwZShpdGVtQ29uZmlnLmNvbXBvbmVudE5hbWUpID09PSAnRk9STV9MQVlPVVQnKSB7CiAgICAgICAgICAgIGlmICggdGhpcy4kcmVmc1tpdGVtQ29uZmlnLnV1aWRdICYmICB0aGlzLiRyZWZzW2l0ZW1Db25maWcudXVpZF1bMF0pIHsKICAgICAgICAgICAgICB0aGlzLiRyZWZzW2l0ZW1Db25maWcudXVpZF1bMF0ucmVzZXRGb3JtKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC8vIHRoaXMuY3VycmVudEZvcm1EYXRhID0gdGhpcy5mb3JtRGF0YTsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIOihqOWNleS6i+S7tuiHquWKqOinpuWPkQogICAgICAgKi8KICAgICAgZm9ybUV2ZW50RW1pdCgkZXZlbnQpIHsKICAgICAgICAvLyDooajljZXkuovku7blj5HpgIEKICAgICAgICB0aGlzLiRiYXNlRm9ybVJlZ2lzdGVyLmV4Y3V0ZUFkYXB0ZXJFdmVudCgkZXZlbnQuY29tcG9uZW50TmFtZSwgJGV2ZW50LCB0aGlzLmZvcm1Db25maWcpCiAgICAgICAgdGhpcy4kZW1pdCgnZm9ybUV2ZW50RW1pdCcsICRldmVudCk7CiAgICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBmb3JtRGF0YTogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbihuZXdWYWwsb2xkVmFsKSB7CiAgICAgICAgaWYgKHRoaXMuY3VycmVudEZvcm1EYXRhICE9PSBuZXdWYWwgJiYgbmV3VmFsKSB7CiAgICAgICAgICB0aGlzLmN1cnJlbnRGb3JtRGF0YSA9IG5ld1ZhbCA7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfSwKICBwcm9wczogewogICAgZm9ybURhdGE6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0OiB7fQogICAgfSwKICAgIGZvcm1Db25maWc6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQ6IFtdCiAgICB9LAogICAgdmFsaWRhdGU6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuY3VycmVudEZvcm1EYXRhID0gdGhpcy5mb3JtRGF0YSA7CiAgfQp9Cg=="},{"version":3,"sources":["dap-ui-basic-form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dap-ui-basic-form.vue","sourceRoot":"packages/components/form/form","sourcesContent":["<!--\n * @Author: DevinShi\n * @Date: 2020-02-06 10:37:47\n * @LastEditors: Please set LastEditors\n * @LastEditTime: 2020-02-20 17:47:57\n * @Description: file content description\n -->\n<template>\n  <!-- 表单渲染，支持JSON Schema格式的渲染方式 -->\n  <div class=\"dap-ui-basic-form dap-ui-form\">\n      <dap-ui-basic-form-item\n        :rowSpan=\"itemConfig.rowSpan\"\n        :colSpan=\"itemConfig.colSpan\"\n        :uuid=\"itemConfig.uuid\"\n        v-for=\"itemConfig of visiableFormConfig\"\n        :key=\"itemConfig.uuid\">\n          <component\n            v-if=\"itemConfig.visiable && $baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_INPUT'\"\n            :has-feedback=\"false\"\n            :label-color=\"itemConfig.labelColor\"\n            :validate-status=\"$v.currentFormData[itemConfig.dataCode].$dirty && $v.currentFormData[itemConfig.dataCode].$error ? 'error' : 'success'\"\n            :help=\"$v.currentFormData[itemConfig.dataCode].$dirty && $v.currentFormData[itemConfig.dataCode].$error ? itemConfig.label + '为必填' : undefined\"\n            :required=\"itemConfig.required\"\n            :is=\"itemConfig.componentName\"\n            :label=\"itemConfig.label\"\n            :value=\"currentFormData[itemConfig.dataCode]\"\n            :uuid=\"itemConfig.uuid\"\n            :options=\"itemConfig.options\"\n            :disabled=\"itemConfig.disabled\"\n            :componentName=\"itemConfig.componentName\"\n            :columns=\"itemConfig.columnSet\"\n            :placeholder=\"itemConfig.placeholder\"\n            @formEventEmit=\"formEventEmit($event)\"\n            @change=\"formValueChange(itemConfig.dataCode, $event)\"></component>\n          \n          <component\n            :label=\"itemConfig.label\"\n            v-if=\"itemConfig.visiable && $baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_STATIC_RENDER'\"\n            :is=\"itemConfig.componentName\"\n            :uuid=\"itemConfig.uuid\"\n            :componentName=\"itemConfig.componentName\"\n            @formEventEmit=\"formEventEmit($event)\"\n            :label-color=\"itemConfig.labelColor\"></component>\n\n          <component\n            :ref=\"itemConfig.uuid\"\n            v-if=\"itemConfig.visiable && $baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_LAYOUT'\"  \n            v-model=\"currentFormData\"\n            @validate=\"validateChange(itemConfig.uuid, $event)\"\n            :layoutConfig=\"itemConfig\"\n            :uuid=\"itemConfig.uuid\"\n            :componentName=\"itemConfig.componentName\"\n            @formEventEmit=\"formEventEmit($event)\"\n            :is=\"itemConfig.componentName\"></component>\n\n            <a-empty \n                image=\"\"\n                v-if=\"!$baseFormRegister.getComponentType(itemConfig.componentName) || !$baseFormRegister.hasComponent(itemConfig.componentName)\">\n                <span slot=\"description\"> `{{itemConfig.componentName}}` 组件未注册 </span>\n            </a-empty>\n      </dap-ui-basic-form-item>\n  </div>\n</template>\n\n<script>\nimport { validationMixin } from 'vuelidate'\nimport { required } from 'vuelidate/lib/validators'\nimport ValidateUtil from '../../../utils/validate.util.js'\n\nexport default {\n  name: \"DapUiBasicForm\",\n  model: {\n    prop: 'formData',\n    event: 'change'\n  },\n  mixins: [validationMixin],\n  data: function() {\n    return {\n      currentFormData: {},\n      childrenValidate: {}\n    }\n  },\n  computed: {\n    visiableFormConfig: function() {\n      return this.formConfig.filter(itemConfig => {\n        return itemConfig && itemConfig.visiable;\n      })\n    }\n  },\n  // 添加验证器\n  validations() {\n    const currentFormData = {};\n    for (let itemConfig of this.formConfig) {\n      if (itemConfig.required) {\n        currentFormData[itemConfig.dataCode] = {\n          required\n        }\n      } else {\n        currentFormData[itemConfig.dataCode] = {}\n      }\n    }\n    return {\n      currentFormData: currentFormData\n    }\n  },\n  methods: {\n      formValueChange(dataCode, value) {\n        this.$set(this.currentFormData, dataCode, value);\n        this.$emit('change', this.currentFormData);\n        this.$v.currentFormData[dataCode].$touch();\n      },\n      validateChange(uuid, value) {\n        this.childrenValidate[uuid] = value;\n      },\n      getValidateError() {\n        let validateArray = [];\n        validateArray.push(this.$v);\n        validateArray = [\n          ...validateArray,\n          ...Object.values(this.childrenValidate)\n        ];\n        return ValidateUtil.mergeValidate(validateArray);\n      },\n      validateTouch() {\n        this.$v.$touch();\n        this.formConfig.forEach(itemConfig => {\n          if (this.$baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_LAYOUT') {\n            if ( this.$refs[itemConfig.uuid] &&  this.$refs[itemConfig.uuid][0]) {\n              this.$refs[itemConfig.uuid][0].validateTouch();\n            }\n          }\n        })\n      },\n      resetForm() {\n        this.$v.$reset();\n        this.formConfig.forEach(itemConfig => {\n          if (this.$baseFormRegister.getComponentType(itemConfig.componentName) === 'FORM_LAYOUT') {\n            if ( this.$refs[itemConfig.uuid] &&  this.$refs[itemConfig.uuid][0]) {\n              this.$refs[itemConfig.uuid][0].resetForm();\n            }\n          }\n        })\n        // this.currentFormData = this.formData;\n      },\n      /**\n       * 表单事件自动触发\n       */\n      formEventEmit($event) {\n        // 表单事件发送\n        this.$baseFormRegister.excuteAdapterEvent($event.componentName, $event, this.formConfig)\n        this.$emit('formEventEmit', $event);\n      }\n  },\n  watch: {\n    formData: {\n      handler: function(newVal,oldVal) {\n        if (this.currentFormData !== newVal && newVal) {\n          this.currentFormData = newVal ;\n        }\n      },\n      deep: true\n    }\n  },\n  props: {\n    formData: {\n      type: Object,\n      default: {}\n    },\n    formConfig: {\n      type: Array,\n      default: []\n    },\n    validate: {\n      type: Object,\n    }\n  },\n  created() {\n    this.currentFormData = this.formData ;\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style src=\"./index.less\" lang=\"less\">\n</style>\n"]}]}