"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var _default={name:"VxeTableFooter",props:{footerData:Array,tableColumn:Array,visibleColumn:Array,fixedColumn:Array,size:String,fixedType:String},mounted:function(){var e=this.$parent,t=this.$el,l=this.$refs,o=this.fixedType,r=e.elemStore,n="".concat(o||"main","-footer-");r["".concat(n,"wrapper")]=t,r["".concat(n,"table")]=l.table,r["".concat(n,"colgroup")]=l.colgroup,r["".concat(n,"list")]=l.tfoot,r["".concat(n,"xSpace")]=l.xSpace},render:function(S){var e=this._e,U=this.$parent,P=this.fixedType,t=this.fixedColumn,k=this.tableColumn,L=this.footerData,E=U.$listeners,l=U.id,o=U.footerRowClassName,F=U.footerCellClassName,r=U.footerRowStyle,q=U.footerCellStyle,A=U.footerAlign,D=U.footerSpanMethod,O=U.align,n=U.scrollXLoad,X=U.columnKey,N=U.showOverflow,R=U.currentColumn,M=U.overflowX,i=U.scrollbarWidth,j=U.getColumnIndex;return D||(P&&N?k=t:n&&P&&(k=t)),S("div",{class:["vxe-table--footer-wrapper",P?"fixed-".concat(P,"--wrapper"):"body--wrapper"],attrs:{"data-tid":l},on:{scroll:this.scrollEvent}},[P?e():S("div",{class:"vxe-body--x-space",ref:"xSpace"}),S("table",{class:"vxe-table--footer",attrs:{"data-tid":l,cellspacing:0,cellpadding:0,border:0},ref:"table"},[S("colgroup",{ref:"colgroup"},k.map(function(e,t){return S("col",{attrs:{name:e.id},key:t})}).concat(i?[S("col",{attrs:{name:"col_gutter"}})]:[])),S("tfoot",{ref:"tfoot"},L.map(function(I,C){return S("tr",{class:["vxe-footer--row",o?_xeUtils.default.isFunction(o)?o({$table:U,$rowIndex:C,fixed:P}):o:""],style:r?_xeUtils.default.isFunction(r)?r({$table:U,$rowIndex:C,fixed:P}):r:null},k.map(function(t,l){var e,o=t.showOverflow,r=t.footerAlign,n=t.align,i=t.footerClassName,a=t.children&&t.children.length,c=P?t.fixed!==P&&!a:t.fixed&&M,s=_xeUtils.default.isUndefined(o)||_xeUtils.default.isNull(o)?N:o,d=r||n||A||O,f="title"===s,u=!0===s||"tooltip"===s,p=f||u||"ellipsis"===s,x={"data-colid":t.id},m={},v=j(t),b=U.tableColumn.indexOf(t),y={$table:U,$rowIndex:C,column:t,columnIndex:v,$columnIndex:l,itemIndex:b,items:I,fixed:P,data:L};if((f||u)&&(m.mouseenter=function(e){f?_tools.DomTools.updateCellTitle(e):u&&U.triggerFooterTooltipEvent(e,{$table:U,$rowIndex:C,column:t,columnIndex:v,$columnIndex:l,itemIndex:b,items:I,fixed:P,data:L,cell:e.currentTarget})}),u&&(m.mouseleave=function(e){u&&U.handleTargetLeaveEvent(e)}),E["header-cell-click"]&&(m.click=function(e){_tools.UtilTools.emitEvent(U,"header-cell-click",[{$table:U,$rowIndex:C,column:t,columnIndex:v,$columnIndex:l,itemIndex:b,items:I,fixed:P,data:L,cell:e.currentTarget},e])}),E["header-cell-dblclick"]&&(m.dblclick=function(e){_tools.UtilTools.emitEvent(U,"header-cell-dblclick",[{$table:U,$rowIndex:C,column:t,columnIndex:v,$columnIndex:l,itemIndex:b,items:I,fixed:P,data:L,cell:e.currentTarget},e])}),D){var _=D(y)||{},h=_.rowspan,g=void 0===h?1:h,$=_.colspan,w=void 0===$?1:$;if(!g||!w)return null;x.rowspan=g,x.colspan=w}var T="seq"===t.type||"index"===t.type?"seq":t.type;return S("td",{class:["vxe-footer--column",t.id,(e={},_defineProperty(e,"col--".concat(d),d),_defineProperty(e,"col--".concat(T),T),_defineProperty(e,"col--last",l===k.length-1),_defineProperty(e,"fixed--hidden",c),_defineProperty(e,"col--ellipsis",p),_defineProperty(e,"filter--active",t.filters&&t.filters.some(function(e){return e.checked})),_defineProperty(e,"col--current",R===t),e),_tools.UtilTools.getClass(i,y),_tools.UtilTools.getClass(F,y)],attrs:x,style:q?_xeUtils.default.isFunction(q)?q(y):q:null,on:m,key:X?t.id:v},[S("div",{class:"vxe-cell"},t.renderFooter(S,y))])}).concat(i?[S("td",{class:"col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,l=this.fixedType,o=t.$refs,r=t.scrollXLoad,n=t.triggerScrollXEvent,i=t.lastScrollLeft,a=o.tableHeader,c=a?a.$el:null,s=o.tableBody.$el,d=o.tableFooter.$el.scrollLeft,f=d!==i;t.lastScrollLeft=d,t.lastScrollTime=Date.now(),c&&(c.scrollLeft=d),s&&(s.scrollLeft=d),r&&f&&n(e),_tools.UtilTools.emitEvent(t,"scroll",[{type:"footer",fixed:l,scrollTop:s.scrollTop,scrollLeft:d,isX:f,isY:!1,$table:t},e])}}};exports.default=_default;