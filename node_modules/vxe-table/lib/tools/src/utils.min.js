"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.UtilTools=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,l){return t&&_defineProperties(e.prototype,t),l&&_defineProperties(e,l),e}var zindexIndex=0,lastZindex=0,columnUniqueId=0,ColumnConfig=function(){function f(e,t){var l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=l.renderHeader,n=l.renderCell,i=l.renderFooter,o=l.renderData;_classCallCheck(this,f);var a=e.$xegrid,s=a?a.proxyOpts:null,u=t.formatter,d=!_xeUtils.default.isBoolean(t.visible)||t.visible;t.cellRender&&t.editRender&&UtilTools.warn("vxe.error.cellEditRender"),"index"===t.type?UtilTools.warn("vxe.error.delProp",["index","seq"]):"selection"===t.type?UtilTools.warn("vxe.error.delProp",["selection","checkbox"]):"expand"===t.type&&(e.treeConfig&&e.treeOpts.line&&UtilTools.error("vxe.error.treeLineExpand"),t.slots&&!t.slots.content&&t.slots.default&&UtilTools.warn("vxe.error.expandContent")),u&&(_xeUtils.default.isString(u)?_xeUtils.default.isFunction(_xeUtils.default[u])||UtilTools.error("vxe.error.notFunc",[u]):_xeUtils.default.isArray(u)&&(_xeUtils.default.isFunction(_xeUtils.default[u[0]])||UtilTools.error("vxe.error.notFunc",[u[0]]))),Object.assign(this,{id:"col_".concat(++columnUniqueId),type:t.type,prop:t.prop,property:t.field||t.prop,title:t.title,label:t.label,width:t.width,minWidth:t.minWidth,resizable:t.resizable,fixed:t.fixed,align:t.align,headerAlign:t.headerAlign,footerAlign:t.footerAlign,showOverflow:t.showOverflow,showHeaderOverflow:t.showHeaderOverflow,className:t.class||t.className,headerClassName:t.headerClassName,footerClassName:t.footerClassName,indexMethod:t.indexMethod,formatter:u,sortable:t.sortable,sortBy:t.sortBy,sortMethod:t.sortMethod,remoteSort:t.remoteSort,filters:UtilTools.getFilters(t.filters),filterMultiple:!_xeUtils.default.isBoolean(t.filterMultiple)||t.filterMultiple,filterMethod:t.filterMethod,filterRender:t.filterRender,treeNode:t.treeNode,cellRender:t.cellRender,editRender:t.editRender,params:t.params,visible:d,defaultVisible:d,checked:!1,disabled:!1,level:1,rowSpan:1,colSpan:1,order:null,renderWidth:0,renderHeight:0,resizeWidth:0,renderLeft:0,renderArgs:[],model:{},renderHeader:r||t.renderHeader,renderCell:n||t.renderCell,renderFooter:i||t.renderFooter,renderData:o,slots:t.slots,own:t}),s&&s.beforeColumn&&s.beforeColumn.apply(e,[{$grid:a,column:this}])}return _createClass(f,[{key:"getTitle",value:function(){return UtilTools.getFuncText(this.own.title||this.own.label||("seq"===this.type||"index"===this.type?_conf.default.i18n("vxe.table.seqTitle"):""))}},{key:"getKey",value:function(){return this.property||(this.type?"type=".concat(this.type):null)}},{key:"update",value:function(e,t){"filters"!==e&&(this[e]=t)}}]),f}();function outLog(r){return function(e,t){var l=UtilTools.getLog(e,t);return console[r](l),l}}var UtilTools={warn:outLog("warn"),error:outLog("error"),getLog:function(e,t){return"[vxe-table] ".concat(_xeUtils.default.template(_conf.default.i18n(e),t))},getSize:function(e){var t=e.size,l=e.$parent;return t||(l&&-1<["medium","small","mini"].indexOf(l.size)?l.size:null)},getFuncText:function(e){return _xeUtils.default.isFunction(e)?e():_conf.default.translate?_conf.default.translate(e):e},nextZIndex:function(e){return e&&e.zIndex?e.zIndex:lastZindex=_conf.default.zIndex+zindexIndex++},getLastZIndex:function(){return lastZindex},getRowkey:function(e){return e.rowId},getRowid:function(e,t){var l=_xeUtils.default.get(t,UtilTools.getRowkey(e));return l?encodeURIComponent(l):""},emitEvent:function(e,t,l){e.$listeners[t]&&e.$emit.apply(e,[t].concat(l))},getColumnList:function(e){var t=[];return e.forEach(function(e){t.push.apply(t,e.children&&e.children.length?UtilTools.getColumnList(e.children):[e])}),t},getClass:function(e,t){return e?_xeUtils.default.isFunction(e)?e(t):e:""},getFilters:function(e){return e&&_xeUtils.default.isArray(e)?e.map(function(e){var t=e.label,l=e.value,r=e.data;return{label:t,value:l,data:r,_data:r,checked:!!e.checked}}):e},formatText:function(e,t){return""+(""===e||null==e?t?_conf.default.emptyCell:"":e)},getCellValue:function(e,t){return _xeUtils.default.get(e,t.property)},getCellLabel:function(e,t,l){var r=t.formatter,n=UtilTools.getCellValue(e,t),i=n;if(l&&r){var o,a,s=l.$table,u=t.id,d=s.fullAllDataRowMap;if(d.has(e)&&((a=(o=d.get(e)).formatData)||(a=d.get(e).formatData={}),o&&a[u]&&a[u].value===n))return a[u].label;i=_xeUtils.default.isString(r)?_xeUtils.default[r]?_xeUtils.default[r](n):"":_xeUtils.default.isArray(r)?_xeUtils.default[r[0]]?_xeUtils.default[r[0]].apply(_xeUtils.default,[n].concat(r.slice(1))):"":r(Object.assign({cellValue:n},l)),a&&(a[u]={value:n,label:i})}return i},setCellValue:function(e,t,l){return _xeUtils.default.set(e,t.property,l)},getColumnConfig:function(e,t,l){return t instanceof ColumnConfig?t:new ColumnConfig(e,t,l)},assemColumn:function(e){var t=e.$el,l=e.$xetable,r=e.$xecolumn,n=e.columnConfig,i=r?r.columnConfig:null;n.slots=e.$scopedSlots,i&&0<r.$children.length?(i.children||(i.children=[]),i.children.splice([].indexOf.call(r.$el.children,t),0,n)):l.collectColumn.splice([].indexOf.call(l.$refs.hideColumn.children,t),0,n)},destroyColumn:function(e){var t=e.$xetable,l=e.columnConfig,r=_xeUtils.default.findTree(t.collectColumn,function(e){return e===l});r&&r.items.splice(r.index,1)},hasChildrenList:function(e){return e&&e.children&&0<e.children.length},parseFile:function(e){var t=e.name,l=_xeUtils.default.lastIndexOf(t,"."),r=t.substring(l+1,t.length);return{filename:t.substring(0,l),type:r}}},_default=exports.UtilTools=UtilTools;exports.default=_default;